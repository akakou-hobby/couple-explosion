let video;
let yolo;
let status;
let objects = [];

function setup() {
    createCanvas(320, 240);
    video = createCapture(VIDEO);
    video.size(320, 240);

    yolo = ml5.YOLO(video, startDetecting);

    video.hide();
    status = select('#status');
}

function draw() {
    image(video, 0, 0, width, height);

    for (let i = 0; i < objects.length; i++) {
        noStroke();
        fill(0, 255, 0);

        text(objects[i].className, objects[i].x * width, objects[i].y * height - 5);
        noFill();
        strokeWeight(4);
        stroke(0, 255, 0);

        rect(objects[i].x * width, objects[i].y * height, objects[i].w * width, objects[i].h * height);
    }
}

function startDetecting() {
    status.html('モデルを読み込んだ');
    detect();
}

function detect() {
    yolo.detect(function (err, results) {
        objects = results;
        console.log(objects)
        detect();
    });
}